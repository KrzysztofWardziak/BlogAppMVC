@model BlogAppMVC.Application.ViewModels.Admin.Blog.NewBlogVm

@{
    ViewData["Title"] = "Dodaj nowy wpis";
}

<h1>Dodaj nowy wpis</h1>

<hr />

@using (Html.BeginForm("AddBlog", "Admin", FormMethod.Post, new { enctype = "multipart/form-data" }))
{
    @Html.AntiForgeryToken()

    <div class="row addblog">
        <div class="col-md-12">
            <form asp-action="AddBlog">
                <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                <div class="form-group">
                    <input type="hidden" asp-for="Id" class="form-control" />
                </div>
                <div class="form-group addblog">
                    <label class="control-label col-md-2">Tytuł</label>
                    <div class="col-md-10">
                        @Html.EditorFor(model => model.Title, new {htmlAttributes = new {@class = "form-control textarea-for"}})
                        @Html.ValidationMessageFor(model => model.Title, "", new {@class = "text-danger"})
                    </div>
                </div>

                <div class="form-group addblog">
                    <label class="control-label col-md-4">Opis</label>
                    <div class="col-md-10">
                        @Html.TextAreaFor(model => model.Text, new { @class = "form-control description", @rows = "8", @cols = "200", @placeholder= "Wpisz treść bloga..." })
                        @Html.ValidationMessageFor(model => model.Text, "", new { @class = "text-danger" })
                    </div>
                </div>
                <div class="form-group">
                    <input type="hidden" asp-for="Slug" class="form-control" />
                </div>

                <div class="form-group col-md-4">
                        <label asp-for="Image" class="control-label">Zdjęcie</label>
                        <input type="file" asp-for="Image" class="form-control" id="ImageUpload"/>
                        <img id="imgpreview" src="#"/>
                </div>

                <div class="form-group addblog col-md-4">
                    <label class="control-label">Kategoria</label>
                    <div>
                        @Html.DropDownListFor(model => model.CategoryId, Model.Categories, "Wybierz kategorie", new { @class = "form-control" })
                        @Html.ValidationMessageFor(model => model.CategoryId, "", new { @class = "text-danger" })
                    </div>
                </div>
                <div class="form-group addblog">
                    <input type="submit" value="Zapisz" class="btn btn-primary" />
                </div>
            </form>
        </div>
    </div>
}
<div>
    <a asp-action="AllBlogs">Powrót do wszystkich wpisów</a>
</div>


@section Scripts {
    <script>

        $(function() {

            // wyswietlanie podgladu obrazka
            function readURL(input) {
                if (input.files && input.files[0]) {
                    var reader = new FileReader();
                    reader.onload = function(e) {
                        $("img#imgpreview").attr("src", e.target.result).width(350).height(250);
                    }
                    reader.readAsDataURL(input.files[0]);
                }
            }

            $("#ImageUpload").change(function() {
                readURL(this);
            });
        });
    </script>
}
